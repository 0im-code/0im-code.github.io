<!DOCTYPE html>
<html>
<head>
  <title>Advanced Goal Tracker</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table, td, th { border: 1px solid black; border-collapse: collapse; }
    th, td { padding: 5px; text-align: center; }
    .done { background-color: #c8f7c5; }
    .notdone { background-color: #f7c5c5; }
    select, input, button { margin: 5px; }
  </style>
</head>
<body>
  <h1>Goal Tracker</h1>

  <label for="monthSelect">Choose Month:</label>
  <select id="monthSelect" onchange="renderTable()">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

  <input type="text" id="newGoalInput" placeholder="Enter a goal">
  <button onclick="addGoal()">Add Goal</button>

  <div id="trackerTable"></div>

  <script>
    let goals = JSON.parse(localStorage.getItem("goals") || "[]");
    let progress = JSON.parse(localStorage.getItem("progress") || "{}");

    function daysInMonth(month) {
      return new Date(2025, parseInt(month), 0).getDate();
    }

    function saveData() {
      localStorage.setItem("goals", JSON.stringify(goals));
      localStorage.setItem("progress", JSON.stringify(progress));
    }

    function addGoal() {
      const input = document.getElementById("newGoalInput");
      const text = input.value.trim();
      if (text === "") return;
      goals.push(text);
      input.value = "";
      saveData();
      renderTable();
    }

    function deleteGoal(index) {
      const month = document.getElementById("monthSelect").value;
      goals.splice(index, 1);
      if (progress[month]) {
        progress[month].splice(index, 1);
      }
      saveData();
      renderTable();
    }

    function toggleStatus(goalIndex, day) {
      const month = document.getElementById("monthSelect").value;
      if (!progress[month]) progress[month] = [];
      if (!progress[month][goalIndex]) progress[month][goalIndex] = [];

      const current = progress[month][goalIndex][day];
      progress[month][goalIndex][day] = current === "‚úî" ? "‚úò" : current === "‚úò" ? "" : "‚úî";

      saveData();
      renderTable();
    }

    function renderTable() {
      const month = document.getElementById("monthSelect").value;
      const days = daysInMonth(month);
      const tableDiv = document.getElementById("trackerTable");

      let html = "<table><thead><tr><th>Goal</th>";
      for (let d = 1; d <= days; d++) html += `<th>${d}</th>`;
      html += "<th>Delete</th></tr></thead><tbody>";

      goals.forEach((goal, i) => {
        html += `<tr><td>${goal}</td>`;
        for (let d = 1; d <= days; d++) {
          const status = (progress[month] && progress[month][i] && progress[month][i][d]) || "";
          const className = status === "‚úî" ? "done" : status === "‚úò" ? "notdone" : "";
          html += `<td class="${className}" onclick="toggleStatus(${i}, ${d})">${status}</td>`;
        }
        html += `<td><button onclick="deleteGoal(${i})">üóëÔ∏è</button></td></tr>`;
      });

      html += "</tbody></table>";
      tableDiv.innerHTML = html;
    }

    renderTable(); // load on page open
  </script>
</body>
</html>
